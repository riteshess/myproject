package pendingvouchersatuser.model.views;

import javax.el.ELContext;
import javax.el.ExpressionFactory;
import javax.el.ValueExpression;

import javax.faces.application.Application;
import javax.faces.context.FacesContext;

import oracle.jbo.Row;
import oracle.jbo.ViewCriteria;

import oracle.jbo.domain.Timestamp;
import oracle.jbo.server.ApplicationModuleImpl;
import oracle.jbo.server.ViewObjectImpl;

import pendingvouchersatuser.model.views.common.PendingVouchersAM;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Wed Apr 30 11:49:21 IST 2014
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class PendingVouchersAMImpl extends ApplicationModuleImpl implements PendingVouchersAM {
    /**
     * This is the default constructor (do not remove).
     */
    public PendingVouchersAMImpl() {
    }

    /**
     * Container's getter for PendingVouchers1.
     * @return PendingVouchers1
     */
    public ViewObjectImpl getPendingVouchers1() {
        return (ViewObjectImpl)findViewObject("PendingVouchers1");
    }
    public String resolvEl(String data){
        FacesContext fc = FacesContext.getCurrentInstance();
        Application app = fc.getApplication();
        ExpressionFactory elFactory = app.getExpressionFactory();
        ELContext elContext = fc.getELContext();
        ValueExpression valueExp = elFactory.createValueExpression(elContext, data, Object.class);
        String Message=valueExp.getValue(elContext).toString();
        return Message;
      }
    public String searchAction() {
        Row curr = this.getSearch().getCurrentRow();
        if (curr != null) {
            String cldId=resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID}");
            Integer usrIdto=Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
            String orgId=resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
            Integer slocId=Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC}"));
            String voucherId = null;
            Integer usrIdBy =null;
            Timestamp vouDt = null;
            Timestamp fwdDt = null;
            String rmks = "";
            if (curr.getAttribute("VoucherIdTrans") != null) {
                voucherId = curr.getAttribute("VoucherIdTrans").toString();
            }
            if (curr.getAttribute("UsrIdTrans") != null) {
                usrIdBy = Integer.parseInt(curr.getAttribute("UsrIdTrans").toString());
            }
            if (curr.getAttribute("VouDtTrans") != null) {
                //vouDt = (Date) curr.getAttribute("VouDtTrans");
            }
            if (curr.getAttribute("FwdDtTrans") != null) {
              //  fwdDt = (Date)curr.getAttribute("FwdDtTrans");
            }
            if (curr.getAttribute("RemarksTrans") != null) {
                rmks = curr.getAttribute("RemarksTrans").toString();
            }
            
            System.out.println(curr.getAttribute("VouDtTrans")+" "+curr.getAttribute("FwdDtTrans"));
            ViewObjectImpl vo = this.getPendingVouchers1();
                     ViewCriteria vc = vo.getViewCriteria("PendingVouchersVOCriteria1");
                     System.out.println(usrIdBy);
                       vo.applyViewCriteria(vc);
                        vo.setNamedWhereClauseParam("BindOrgId",orgId);
                        vo.setNamedWhereClauseParam("BindSlocId",slocId);
                        vo.setNamedWhereClauseParam("BindUsrId",usrIdto);
                        vo.setNamedWhereClauseParam("BindCldId",cldId);
                       vo.setNamedWhereClauseParam("FwdByBind", usrIdBy);
                       vo.setNamedWhereClauseParam("remarks",rmks);
                       vo.setNamedWhereClauseParam("VouDtBind", curr.getAttribute("VouDtTrans"));
                       vo.setNamedWhereClauseParam("vocherNoBind", voucherId);
                       vo.setNamedWhereClauseParam("crtDtBind",curr.getAttribute("FwdDtTrans"));
                       vo.executeQuery();
        }
        return null;
    }

    public String resetAction(){
        String cldId=resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID}");
        Integer usrIdto=Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
        String orgId=resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        Integer slocId=Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC}"));
        Row curr = this.getSearch().getCurrentRow();
        ViewObjectImpl vo = this.getPendingVouchers1();
                 ViewCriteria vc = vo.getViewCriteria("PendingVouchersVOCriteria1");
                 
                   vo.applyViewCriteria(vc);
        vo.setNamedWhereClauseParam("BindOrgId",orgId);
        vo.setNamedWhereClauseParam("BindSlocId",slocId);
        vo.setNamedWhereClauseParam("BindUsrId",usrIdto);
        vo.setNamedWhereClauseParam("BindCldId",cldId);
                   vo.setNamedWhereClauseParam("FwdByBind", null);
                   vo.setNamedWhereClauseParam("remarks",null);
                   vo.setNamedWhereClauseParam("crtDtBind",null);
                   vo.setNamedWhereClauseParam("vocherNoBind", null);
                   vo.setNamedWhereClauseParam("VouDtBind", null);
                   vo.executeQuery();
        return null;
    }
    /**
     * Container's getter for Search.
     * @return Search
     */
    public ViewObjectImpl getSearch() {
        return (ViewObjectImpl)findViewObject("Search");
    }
}
